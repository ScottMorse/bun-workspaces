name: Setup Project
description: Setup the project for the workflow

inputs:
  bun_version:
    description: The Bun version to test
    required: false

runs:
  using: composite
  steps:
    - name: Get Bun version
      if: inputs.bun_version == null
      id: get-bun-version
      shell: bash
      run: |
        BUN_VERSION=$(cat packages/bun-workspaces/package.json | jq -r '._bwInternal.bunVersion.build')
        echo BUN_VERSION=$BUN_VERSION >> $GITHUB_ENV
        echo "Bun version to be installed: $BUN_VERSION"

    - name: Install Bun
      uses: oven-sh/setup-bun@v2
      with:
        bun-version: ${{ inputs.bun_version || env.BUN_VERSION }}

    - name: Install Dependencies
      id: install-deps
      shell: bash
      run: |
        bun install --frozen-lockfile
